[
  {
    "objectID": "LICENSE.html",
    "href": "LICENSE.html",
    "title": "MIT License",
    "section": "",
    "text": "MIT License\nCopyright (c) 2025 synth-steno authors\nPermission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the “Software”), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\nThe above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\nTHE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE."
  },
  {
    "objectID": "practicals/day1_afternoon.html",
    "href": "practicals/day1_afternoon.html",
    "title": "Causal prediction for medical decision making. Practicals day 1 afternoon",
    "section": "",
    "text": "Learning objectives\n\nRead about the data, read it into R, and examine the data and benchmark models\nMake your own prediction model using the training dataset\nProvide an estimate of some metric to quantify how well your model performs using test data or cross validation\nPredict the probability of the outcome in the validation set and send the predictions to the teachers.\n\n\n\nData description\nWe have synthesized data alike the training data behind the Steno type 1 risk engine. The data are not real data but obtained by computer simulation for the sole purpose of illustrating the methods discussed during the workshop. Since we have simulated the data we have removed the obstacles from censoring and provide a binary outcome variable which indicates if CVD occured before the 5 years horizon where no occurrence means either death without CVD or alive without CVD.\n\nStudy population: Adults with type 1 diabetes. It is recommended for patients to come for regular follow-up visits every 4 months. These data represent information available from the past year at the time that the predictions are to be made (time 0), which includes some measurements at 2 time points. The variable pid is a unique patient identifier.\nTime zero: Date of a screening visit at diabetes center\nOutcome: Cardiovascular disease within 5 years of time 0. The is coded as 0 for no, 1 for yes, in the variable cvd5year\nPredictors: all measured at or before time 0\n\nage: Age in years at the time 0\nsex_male: Binary indicator of male sex (0 = female, 1 = male)\ndiabetes_duration: Time in years since diagnosis of type 1 diabetes\nsmoking: Binary indicator of current smoking status (0 = nonsmoker, 1 = smoker)\nmotion: Binary indicator of regular physical activity (0 = sedentary, 1 = some moderate physical activity)\nHBA1C_time1, HBA1C_time2: Glycated hemoglobin, also called hemoglobin A1C value at two time points in mmol/mol. Smaller values indicate better glycemic control.\nurine_albumin_time1, urine_albumin_time2: The urine albumin to creatinine ratio, in mg/g. A larger relative concentration of albumin in the urine is an indicator of poor kidney function\nLDL_time1, LDL_time2: Low-density lipoprotein measurement in serum, in mmol/L.\nSBP_time1, SBP_time2: Systolic blood pressure in mmHg\neGFR_time1, eGFR_time2: Estimated glomerular filtration rate, in \\(mL/min/1.73m^2\\). An estimate of kidney function, larger values means better kidney function\nstatin: indicator of statin use between times 1 and 2 (0 = not on statins, 1 = on statins)\n\n\n\n\nExercises\n\nLoad the R package riskRegression\n\n\nlibrary(riskRegression) \n\n\nRead the train and the test data into R\n\n\ntrain &lt;- readRDS(url(\"https://github.com/sachsmc/causal-prediction-workshop/raw/refs/heads/master/practicals/type1-diabetes-train.rds\"))\ntest &lt;- readRDS(url(\"https://github.com/sachsmc/causal-prediction-workshop/raw/refs/heads/master/practicals/type1-diabetes-test.rds\"))\n\n\nWhat is the prevalence of CVD 5 years after time zero?\n\n\n100*mean(train$cvd_5year) \n\n\nNote that the null model ignores the covariates and predicts the same risk to everyone. It can be obtained with the glm function as follows:\n\n\nnull_model &lt;- glm(cvd_5year~1,data = train, family = \"binomial\")\npredictRisk(null_model,newdata = test) \n\n\nFit a bench mark model using logistic regression including additive effects of sex, age and diabetes duration\n\n\nbench_model &lt;- glm(cvd_5year~sex_male + age + diabetes_duration,data = train, family = \"binomial\") \n\n\nFit a model which resembles the formula of the Steno 1 risk engine using logistic regression\n\n\nsteno_model &lt;- glm(cvd_5year~sex_male + age + diabetes_duration + smoking + motion +\n                  HBA1C_time1 + urine_albumin_time1 + LDL_time1 + SBP_time1 + eGFR_time1,\n                  data = train, family = \"binomial\") \n\n\nDoes the Steno model outperform the benchmark model in the train data? Use 10-fold cross-validation\n\n\nx &lt;- riskRegression::Score(list(\"Benchmark model\" = bench_model,\n                                \"Steno model\" = steno_model),\n                           data = train,\n                           seed = 8,\n                           null.model = TRUE,\n                           formula = cvd_5year~1,\n                           split.method = \"cv10\",\n                           summary = \"risk\",\n                           plots = c(\"roc\",\"cal\"))\nsummary(x)\nplotRisk(x)\nplotROC(x)\nplotCalibration(x) \n\n\nDoes the Steno model outperform the benchmark model in the test data?\n\n\ny &lt;- riskRegression::Score(list(\"Benchmark model\" = bench_model,\n                                \"Steno model\" = steno_model),\n                           data = test,\n                           null.model = TRUE,\n                           formula = cvd_5year~1,\n                           summary = \"risk\",\n                           plots = c(\"roc\",\"cal\"))\nsummary(y)\nplotRisk(y)\nplotROC(y)\nplotCalibration(y) \n\n\nUse any method to make a new risk prediction model and compare it to the Steno model on the test data. Note that the Score function allows you to specify a vector with predicted risks. Here is an example using random forests based on the R-package ranger.\n\n\nlibrary(ranger)\nrf &lt;- ranger(cvd_5year~sex_male + age + diabetes_duration,data = train,\n             probability = TRUE,seed = 9)\npred_ranger &lt;- predict(rf,data = test)$predictions[,2]\nz &lt;- riskRegression::Score(list(\"Benchmark model\" = bench_model,\n                                \"Steno model\" = steno_model,\n                                \"Random forest\" = pred_ranger),\n                           data = test,\n                           null.model = TRUE,\n                           formula = cvd_5year~1,\n                           summary = \"risk\",\n                           plots = c(\"roc\",\"cal\"))\nsummary(z)\nplotRisk(z)\nplotROC(z)\nplotCalibration(z) \n\n\nOnce you have decided on your new risk prediction model, load the validation dataset and produce predicted probabilities of cvd_5year. Insert them into a new variable in the validation dataset, save the result\n\n\nvalid &lt;- readRDS(url(\"https://github.com/sachsmc/causal-prediction-workshop/raw/refs/heads/master/practicals/data/type1-diabetes-valid.rds\"))\n\nvalid$riskest &lt;- predict(rf, data = valid)$predictions[, 2]\n\nsaveRDS(valid, file = stop(\"replace 'stop(\\\"replace ...\\\")' with a unique team filename ending in .rds\"))\n\n\nSend an email to michael.sachs@sund.ku.dk with the following information:\n\nThe file you just saved as an attachment. It must contain at least the pid and riskest columns.\nThe name of the file that you attached.\nYour team name.\nAn estimate of the AUC of your model from either cross-validation or the test dataset."
  }
]